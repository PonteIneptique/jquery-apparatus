(function(e){e.fn.apparatus=function(t){var n=this;var r=function(t){var n=[],r=0;while(r<=t.length-1){var i=e(t[r]);if(typeof i.data("category")==="string"&&e.inArray(i.data("category"),n)===-1){n.push(i.data("category"))}r++}return n};var i=function(e,t){if(typeof t==="undefined"){t=false}var n=e,r=[];if(e.length>2){var n=[e[0],e[1]]}else if(e.length==1){return e}if(t===true){for(var s=0;s<n[0].length;s++){r.push(n[0][s])}}if(n[1].length>0&&n[0].length>0){for(var s=0;s<n[1].length;s++){if(t===true){r.push(n[1][s])}for(var o=0;o<n[0].length;o++){r.push(n[0][o]+n[1][s])}}}else if(n[1].length>0){for(var s=0;s<n[1].length;s++){r.push(n[1][s])}}else if(n[0].length>0){for(var s=0;s<n[0].length;s++){r.push(n[0][s])}}if(e.length>2){e=e.slice(2,e.length);e.push(r);return i(e,t)}else{return r}};var s=function(e,t){var n={active:"active",facets:[],target:"choice-apparatus"};if(typeof e==="object"){if(typeof e.active==="string"&&e.active.length>0){n.active=e.active}if(typeof e.target==="string"&&e.target.length>0){n.target=e.target}if(typeof e.facets!=="undefined"&&Object.prototype.toString.call(param.facets)==="[object Array]"&&param.facets.length>0){n.facets=param.facets}else{n.facets=r(t)}}else if(typeof e==="string"){n.target=e;n.facets=r(t)}if(n.facets.length<2){n.facets=[t.selector]}return n};var o=function(e){return Object.keys(e).map(function(t){return e[t]})};var t=s(t,n);var u=function(t){var n={};if(typeof t.facets==="object"&&t.facets.length!=0){var r=0;while(r<t.facets.length){if(typeof n[t.facets[r]]==="undefined"){n[t.facets[r]]=[]}e(t.facets[r]+":checked").each(function(){n[t.facets[r]].push(e(this).attr("data-target"))});r++}var r=0,s=i(o(n)),n=s.join(", ")}else{var n=[];e(t.facets+":checked").each(function(){n.push(e(this).attr("data-target"))});var n=n.join(", ")}return n};var a=0;while(a<n.length){e(n[a]).on("change",function(n){t.selector=u(t);if(t.selector==t.target){e(t.target).removeClass(t.active)}else{e(t.selector).addClass("active");e(t.target+":not("+t.selector+")").removeClass(t.active)}});a++}return this}})(jQuery)